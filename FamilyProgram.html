    <!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>شجره خانواده</title>
<style>
body {
    font-family: sans-serif;
    background: #f0f0f0;
    margin: 0;
    padding: 20px;
    text-align: center;
}

.note {
    background: #fff3cd;
    color: #856404;
    padding: 12px;
    border-radius: 12px;
    margin-bottom: 20px;
    border: 1px solid #ffeeba;
    font-size: 15px;
}

.node {
    padding: 10px 15px;
    border-radius: 10px;
    color: #fff;
    cursor: pointer;
    border: none;
    transition: 0.2s;
    font-size: 16px;
    position: relative;
    z-index: 1;
}

.node:hover {
    opacity: 0.9;
}

.siblings {
    display: none;
    justify-content: center;
    flex-wrap: wrap;
    gap: 60px;
    position: relative;
    margin-top: 40px;
}

.children {
    display: none;
    justify-content: center;
    flex-wrap: wrap;
    gap: 30px;
    position: relative;
    margin-top: 20px;
}

.child {
    padding: 6px 12px;
    border-radius: 8px;
    background: #e0e0e0;
    color: #333;
    font-size: 14px;
    position: relative;
    z-index: 1;
}

svg {
    position: absolute;
    top: 0;
    left: 0;
    overflow: visible;
    pointer-events: none;
    z-index: 0;
}

@media (max-width: 500px) {
    .siblings, .children {
        flex-direction: column;
        gap: 40px;
    }
}
</style>
</head>
<body>

<div class="note">
    روی نام هر فرد کلیک کنید تا فرزندانش باز شوند
</div>

<div>
    <button class="node" style="background:#007bff;" onclick="toggle('siblings')">حاج عزیزاله شاکری</button>
</div>

<svg id="lines"></svg>

<div id="siblings" class="siblings">

    <div class="family">
        <button class="node" style="background:#6f42c1;" onclick="toggle('c1')">کوروش شاکری</button>
        <div id="c1" class="children">
            <div class="child">محمد حسین شاکری</div>
            <div class="child">علیرضا شاکری</div>
        </div>
    </div>

    <div class="family">
        <button class="node" style="background:#28a745;" onclick="toggle('c2')">عباس شاکری</button>
        <div id="c2" class="children">
            <div class="child">سروش شاکری</div>
            <div class="child">یاسین شاکری</div>
        </div>
    </div>

    <div class="family">
        <button class="node" style="background:#dc3545;" onclick="toggle('c3')">یوسف شاکری</button>
        <div id="c3" class="children">
            <div class="child">حسین شاکری</div>
            <div class="child">ابوالفضل شاکری</div>
        </div>
    </div>

    <div class="family">
        <button class="node" style="background:#fd7e14;" onclick="toggle('c4')">ایوب شاکری</button>
        <div id="c4" class="children">
            <div class="child">محمدجواد شاکری</div>
        </div>
    </div>

    <div class="family">
        <button class="node" style="background:#20c997;" onclick="toggle('c5')">یونس شاکری</button>
        <div id="c5" class="children">
            <div class="child">محمدرضا شاکری</div>
            <div class="child">امیررضا شاکری</div>
        </div>
    </div>

    <div class="family">
        <button class="node" style="background:#6610f2;" onclick="toggle('c6')">اشکان شاکری</button>
        <div id="c6" class="children">
            <div class="child">مهدی شاکری</div>
            <div class="child">آریو شاکری</div>
        </div>
    </div>

</div>

<script>
function toggle(id) {
    const el = document.getElementById(id);
    if (el.style.display === "flex") {
        el.style.display = "none";
    } else {
        el.style.display = "flex";
    }
    // رسم خطوط بعد از یک فریم، مخصوص موبایل
    requestAnimationFrame(drawLines);
}

function drawLines() {
    const svg = document.getElementById('lines');
    svg.innerHTML = '';

    const father = document.querySelector('button.node');
    const fatherRect = father.getBoundingClientRect();
    const fatherX = fatherRect.left + fatherRect.width / 2 + window.scrollX;
    const fatherY = fatherRect.bottom + window.scrollY;

    const families = document.querySelectorAll('.family');
    families.forEach(fam => {
        const childBtn = fam.querySelector('button.node');
        if (childBtn.offsetParent !== null) {
            const childRect = childBtn.getBoundingClientRect();
            const childX = childRect.left + childRect.width / 2 + window.scrollX;
            const childY = childRect.top + window.scrollY;

            const line = document.createElementNS('http://www.w3.org/2000/svg','line');
            line.setAttribute('x1', fatherX);
            line.setAttribute('y1', fatherY);
            line.setAttribute('x2', childX);
            line.setAttribute('y2', childY);
            line.setAttribute('stroke', '#555');
            line.setAttribute('stroke-width', '2');
            svg.appendChild(line);
        }

        const children = fam.querySelectorAll('.child');
        children.forEach(grand => {
            if (grand.offsetParent !== null) {
                const parentRect = childBtn.getBoundingClientRect();
                const parentX = parentRect.left + parentRect.width / 2 + window.scrollX;
                const parentY = parentRect.bottom + window.scrollY;

                const grandRect = grand.getBoundingClientRect();
                const grandX = grandRect.left + grandRect.width / 2 + window.scrollX;
                const grandY = grandRect.top + window.scrollY;

                const line = document.createElementNS('http://www.w3.org/2000/svg','line');
                line.setAttribute('x1', parentX);
                line.setAttribute('y1', parentY);
                line.setAttribute('x2', grandX);
                line.setAttribute('y2', grandY);
                line.setAttribute('stroke', '#555');
                line.setAttribute('stroke-width', '2');
                svg.appendChild(line);
            }
        });
    });
}

// بروزرسانی خطوط هنگام تغییر اندازه یا scroll
window.addEventListener('resize', () => requestAnimationFrame(drawLines));
window.addEventListener('scroll', () => requestAnimationFrame(drawLines));
</script>

</body>
</html>
